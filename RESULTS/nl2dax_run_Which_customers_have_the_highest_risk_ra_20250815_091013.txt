
========== NATURAL LANGUAGE QUERY ==========
Which customers have the highest risk ratings?

========== GENERATED SQL ==========
SELECT CUSTOMER_KEY,
       CUSTOMER_ID,
       CUSTOMER_NAME,
       RISK_RATING_CODE,
       RISK_RATING_DESCRIPTION
FROM FIS_CUSTOMER_DIMENSION
WHERE RISK_RATING_CODE = (
    SELECT MAX(RISK_RATING_CODE)
    FROM FIS_CUSTOMER_DIMENSION
);

========== SQL QUERY RESULTS (TABLE) ==========
CUSTOMER_KEY | CUSTOMER_ID | CUSTOMER_NAME                 | RISK_RATING_CODE | RISK_RATING_DESCRIPTION
-------------+-------------+-------------------------------+------------------+------------------------
1            | CUST001     | Desert Manufacturing LLC      | B+               | Good Credit Quality    
1003         | CUST006     | Mountain Capital Advisors LLC | B+               | Good Credit Quality    

========== GENERATED DAX ==========
EVALUATE, SELECTCOLUMNS with FILTER, and CALCULATE/ALL() to find the global maximum risk-rating code:

EVALUATE
SELECTCOLUMNS(
    FILTER(
        'FIS_CUSTOMER_DIMENSION',
        'FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE]
            = CALCULATE(
                MAX('FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE]),
                ALL('FIS_CUSTOMER_DIMENSION')
            )
    ),
    "CustomerKey",             'FIS_CUSTOMER_DIMENSION'[CUSTOMER_KEY],
    "CustomerName",            'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "RiskRatingCode",          'FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE],
    "RiskRatingDescription",   'FIS_CUSTOMER_DIMENSION'[RISK_RATING_DESCRIPTION]
)

========== FORMATTED DAX ==========
EVALUATE, SELECTCOLUMNS with FILTER, and CALCULATE/ALL() to find the global maximum risk-rating code:

EVALUATE
SELECTCOLUMNS(
    FILTER(
        'FIS_CUSTOMER_DIMENSION',
        'FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE]
            = CALCULATE(
                MAX('FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE]),
                ALL('FIS_CUSTOMER_DIMENSION')
            )
    ),
    "CustomerKey",             'FIS_CUSTOMER_DIMENSION'[CUSTOMER_KEY],
    "CustomerName",            'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "RiskRatingCode",          'FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE],
    "RiskRatingDescription",   'FIS_CUSTOMER_DIMENSION'[RISK_RATING_DESCRIPTION]
)

========== DAX EXECUTION WARNING ==========
[WARN] Skipping DAX execution: DAX over HTTP/XMLA failed. Check PBI_* env vars, XMLA endpoint, dataset name, and permissions. Root error: Power BI Execute Queries API failed with HTTP 400. Error details: {"error":{"code":"DatasetExecuteQueriesError","pbi.error":{"code":"DatasetExecuteQueriesError","parameters":{},"details":[{"code":"DetailsMessage","detail":{"type":1,"value":"Query (1, 9) The syntax for ',' is incorrect. (EVALUATE, SELECTCOLUMNS with FILTER, and CALCULATE/ALL() to find the global maximum risk-rating code:\n\nEVALUATE\nSELECTCOLUMNS(\n    FILTER(\n        'FIS_CUSTOMER_DIMENSION',\n        'FIS_CUSTOMER_DIMENSION'[RISK_RATING_CODE]\n            = CALCULATE(\n                MAX('

========== RUN DURATION ==========
Run duration: 42.27 seconds
