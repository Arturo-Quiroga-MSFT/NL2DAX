
========== NATURAL LANGUAGE QUERY ==========
show me top 3 customers

========== GENERATED SQL ==========
SELECT TOP 3
  c.CUSTOMER_ID,
  c.CUSTOMER_NAME,
  SUM(f.OUTSTANDING_BALANCE) AS TotalOutstandingBalance
FROM FIS_CL_DETAIL_FACT AS f
JOIN FIS_CUSTOMER_DIMENSION AS c
  ON f.CUSTOMER_KEY = c.CUSTOMER_KEY
WHERE f.MONTH_ID = (
  SELECT MAX(MONTH_ID)
  FROM FIS_CL_DETAIL_FACT
)
GROUP BY
  c.CUSTOMER_ID,
  c.CUSTOMER_NAME
ORDER BY
  TotalOutstandingBalance DESC;

========== SQL QUERY ERROR ==========
[ERROR] Failed to execute SQL query: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'OUTSTANDING_BALANCE'. (207) (SQLExecDirectW)")

========== GENERATED DAX ==========
EVALUATE
SELECTCOLUMNS(
    TOPN(
        3,
        ADDCOLUMNS(
            'FIS_CUSTOMER_DIMENSION',
            "TotalLoanBalance", CALCULATE( SUM( 'FIS_CL_DETAIL_FACT'[OUTSTANDING_BALANCE] ) ),
            "TotalAccountBalance", CALCULATE( SUM( 'FIS_CA_DETAIL_FACT'[CURRENT_BALANCE] ) ),
            "TotalBalance", [TotalLoanBalance] + [TotalAccountBalance]
        ),
        [TotalBalance], DESC
    ),
    "CustomerID", 'FIS_CUSTOMER_DIMENSION'[CUSTOMER_ID],
    "CustomerName", 'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "TotalBalance", [TotalBalance]
)

========== FORMATTED DAX ==========
EVALUATE
SELECTCOLUMNS(
    TOPN(
        3,
        ADDCOLUMNS(
            'FIS_CUSTOMER_DIMENSION',
            "TotalLoanBalance", CALCULATE( SUM( 'FIS_CL_DETAIL_FACT'[OUTSTANDING_BALANCE] ) ),
            "TotalAccountBalance", CALCULATE( SUM( 'FIS_CA_DETAIL_FACT'[CURRENT_BALANCE] ) ),
            "TotalBalance", [TotalLoanBalance] + [TotalAccountBalance]
        ),
        [TotalBalance], DESC
    ),
    "CustomerID", 'FIS_CUSTOMER_DIMENSION'[CUSTOMER_ID],
    "CustomerName", 'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "TotalBalance", [TotalBalance]
)

========== DAX EXECUTION WARNING ==========
[WARN] Skipping DAX execution: DAX over HTTP/XMLA failed. Check PBI_* env vars, XMLA endpoint, dataset name, and permissions. Root error: Power BI Execute Queries API failed with HTTP 400. Error details: {"error":{"code":"DatasetExecuteQueriesError","pbi.error":{"code":"DatasetExecuteQueriesError","parameters":{},"details":[{"code":"DetailsMessage","detail":{"type":1,"value":"Query (7, 49) Column '<oii>OUTSTANDING_BALANCE</oii>' in table '<oii>FIS_CL_DETAIL_FACT</oii>' cannot be found or may not be used in this expression."}},{"code":"AnalysisServicesErrorCode","detail":{"type":1,"value":"3241803780"}}]}}}

========== RUN DURATION ==========
Run duration: 38.57 seconds
