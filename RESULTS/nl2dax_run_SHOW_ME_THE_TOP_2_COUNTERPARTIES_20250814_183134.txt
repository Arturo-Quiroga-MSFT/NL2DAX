
========== NATURAL LANGUAGE QUERY ==========
SHOW ME THE TOP 2 COUNTERPARTIES

========== GENERATED SQL ==========
SELECT 
    CUSTOMER_NAME,
    ENTITY_TYPE,
    RISK_RATING,
    INDUSTRY,
    COUNTRY,
    RELATIONSHIP_MANAGER,
    LOAN_COUNT,
    TOTAL_EXPOSURE_USD,
    TOTAL_CREDIT_LIMIT_USD,
    UTILIZATION_PERCENTAGE,
    AVG_INTEREST_RATE,
    PORTFOLIO_PERCENTAGE,
    CONCENTRATION_RISK,
    RELATIONSHIP_DEPTH
FROM FIS_TOP_COUNTERPARTIES_ANALYSIS
WHERE COUNTERPARTY_RANK <= 2
ORDER BY COUNTERPARTY_RANK;

========== SQL QUERY RESULTS (TABLE) ==========
CUSTOMER_NAME             | ENTITY_TYPE               | RISK_RATING                 | INDUSTRY                             | COUNTRY       | RELATIONSHIP_MANAGER | LOAN_COUNT | TOTAL_EXPOSURE_USD | TOTAL_CREDIT_LIMIT_USD | UTILIZATION_PERCENTAGE | AVG_INTEREST_RATE | PORTFOLIO_PERCENTAGE | CONCENTRATION_RISK | RELATIONSHIP_DEPTH
--------------------------+---------------------------+-----------------------------+--------------------------------------+---------------+----------------------+------------+--------------------+------------------------+------------------------+-------------------+----------------------+--------------------+-------------------
Desert Manufacturing LLC  | Corporation               | Good Credit Quality         | Manufacturing - Industrial Equipment | United States | Sarah Johnson        | 1          | 3750000.00         | 5000000.00             | 75.00                  | 6.7500            | 41.40                | HIGH               | SINGLE PRODUCT    
Southwest Energy Partners | Limited Liability Company | Satisfactory Credit Quality | Oil and Gas Exploration              | United States | Lisa Rodriguez       | 1          | 2625000.00         | 3500000.00             | 75.00                  | 7.6000            | 29.00                | HIGH               | SINGLE PRODUCT    

========== GENERATED DAX ==========
EVALUATE
SELECTCOLUMNS(
    TOPN(
        2,
        ADDCOLUMNS(
            'FIS_CUSTOMER_DIMENSION',
            "TotalCurrentBalance",
                CALCULATE(
                    SUM( 'FIS_CL_DETAIL_FACT'[CURRENT_PRINCIPAL_BALANCE] )
                )
        ),
        [TotalCurrentBalance], DESC
    ),
    "CustomerKey",       'FIS_CUSTOMER_DIMENSION'[CUSTOMER_KEY],
    "CustomerName",      'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "TotalBalance",      [TotalCurrentBalance]
)

========== FORMATTED DAX ==========
EVALUATE
SELECTCOLUMNS(
    TOPN(
        2,
        ADDCOLUMNS(
            'FIS_CUSTOMER_DIMENSION',
            "TotalCurrentBalance",
                CALCULATE(
                    SUM( 'FIS_CL_DETAIL_FACT'[CURRENT_PRINCIPAL_BALANCE] )
                )
        ),
        [TotalCurrentBalance], DESC
    ),
    "CustomerKey",       'FIS_CUSTOMER_DIMENSION'[CUSTOMER_KEY],
    "CustomerName",      'FIS_CUSTOMER_DIMENSION'[CUSTOMER_NAME],
    "TotalBalance",      [TotalCurrentBalance]
)

========== DAX QUERY RESULTS (TABLE) ==========
[CustomerKey] | [CustomerName]                    | [TotalBalance]
--------------+-----------------------------------+---------------
1002          | Atlantic Biomedical Corporation   | 9050000.0     
1004          | Northwest Retail Enterprises Inc. | 9050000.0     
1003          | Mountain Capital Advisors LLC     | 9050000.0     
1             | Desert Manufacturing LLC          | 9050000.0     
2             | Palm Investors Inc.               | 9050000.0     
3             | Southwest Energy Partners         | 9050000.0     
4             | Pacific Technology Solutions      | 9050000.0     

========== RUN DURATION ==========
Run duration: 69.32 seconds
