
========== NATURAL LANGUAGE QUERY ==========
List top 10 customers by balance

========== EXECUTION TIMESTAMP ==========
2025-08-15 15:48:54

========== GENERATED SQL ==========
SELECT TOP 10
    [c].[CUSTOMER_NAME],
    SUM([f].[CURRENT_PRINCIPAL_BALANCE]) AS [TotalBalance]
FROM [dbo].[FIS_CL_DETAIL_FACT] AS [f]
INNER JOIN [dbo].[FIS_CUSTOMER_DIMENSION] AS [c]
    ON [f].[CUSTOMER_KEY] = [c].[CUSTOMER_KEY]
GROUP BY [c].[CUSTOMER_NAME]
ORDER BY [TotalBalance] DESC;

========== GENERATED DAX ==========
EVALUATE
TOPN(
    10,
    SUMMARIZE(
        FIS_CL_DETAIL_FACT,
        FIS_CL_DETAIL_FACT[CUSTOMER_KEY],
        FIS_CUSTOMER_DIMENSION[CUSTOMER_NAME],
        "TotalBalance", SUM(FIS_CL_DETAIL_FACT[TOTAL_BALANCE])
    ),
    [TotalBalance],
    DESC
)

========== PIPELINE CONFIGURATION ==========
- OpenAI Model: o4-mini
- API Version: 2024-12-01-preview
- Database: Azure SQL Database
- Caching Enabled: No

========== SQL EXECUTION RESULTS ==========
Status: ✅ SUCCESS
Execution Time: 1.073 seconds
Rows Returned: 4
Columns: 2

========== SQL QUERY RESULTS (TABLE) ==========
CUSTOMER_NAME             | TotalBalance             
------------------------- | -------------------------
Desert Manufacturing LLC  | 3750000.00               
Southwest Energy Partners | 2625000.00               
Palm Investors Inc.       | 1875000.00               
Pacific Technology Soluti | 800000.00                

========== DAX EXECUTION RESULTS ==========
Status: ❌ FAILED
Error: Could not translate DAX query to SQL

========== RESULTS COMPARISON ==========
Results Match: ❌ NO
SQL Rows: 0
DAX Rows: 0
Summary: Cannot compare - one or both queries failed

Differences Found:
1. DAX query failed: Could not translate DAX query to SQL

========== PERFORMANCE ANALYSIS ==========
Total Pipeline Execution Time: 0.000 seconds
SQL Generation Time: 0.000 seconds
DAX Generation Time: 0.000 seconds
SQL Execution Time: 1.073 seconds
DAX Execution Time: 0.000 seconds

========== SCHEMA INFORMATION ==========
Database: Azure SQL Database
Tables Available: 0

========== ENVIRONMENT DETAILS ==========
Execution Environment: Streamlit Web Interface
Pipeline Version: Unified NL2SQL & DAX Pipeline
Report Generated: 2025-08-15 15:48:54
Working Directory: /Users/arturoquiroga/GITHUB/NL2DAX/CODE/NL2SQL_DAX_UNIFIED_PIPELINE

========== PIPELINE STATUS ==========
✅ Schema Reading: Complete
✅ SQL Generation: Complete
✅ DAX Generation: Complete
✅ SQL Execution: Complete
✅ DAX Execution: Failed
✅ Results Comparison: Complete
✅ Report Generation: Complete

---
Generated by NL2DAX Unified Pipeline - 2025-08-15 15:48:54
