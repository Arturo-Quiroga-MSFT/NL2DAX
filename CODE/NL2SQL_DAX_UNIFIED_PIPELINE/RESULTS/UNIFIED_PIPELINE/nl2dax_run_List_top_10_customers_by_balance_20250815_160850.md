
========== NATURAL LANGUAGE QUERY ==========
List top 10 customers by balance

========== EXECUTION TIMESTAMP ==========
2025-08-15 16:08:50

========== GENERATED SQL ==========
SELECT TOP 10
    cd.[CUSTOMER_ID],
    cd.[CUSTOMER_NAME],
    SUM(cf.[TOTAL_BALANCE]) AS [TotalBalance]
FROM dbo.[FIS_CL_DETAIL_FACT] AS cf
INNER JOIN dbo.[FIS_CUSTOMER_DIMENSION] AS cd
    ON cf.[CUSTOMER_KEY] = cd.[CUSTOMER_KEY]
GROUP BY
    cd.[CUSTOMER_ID],
    cd.[CUSTOMER_NAME]
ORDER BY
    SUM(cf.[TOTAL_BALANCE]) DESC;

========== GENERATED DAX ==========
EVALUATE
TOPN(
    10,
    SUMMARIZE(
        FIS_CUSTOMER_DIMENSION,
        FIS_CUSTOMER_DIMENSION[CUSTOMER_KEY],
        FIS_CUSTOMER_DIMENSION[CUSTOMER_NAME],
        "Balance", CALCULATE(SUM(FIS_CL_DETAIL_FACT[TOTAL_BALANCE]))
    ),
    [Balance], DESC
)

========== PIPELINE CONFIGURATION ==========
- OpenAI Model: o4-mini
- API Version: 2024-12-01-preview
- Database: Azure SQL Database
- Caching Enabled: No

========== SQL EXECUTION RESULTS ==========
Status: ✅ SUCCESS
Execution Time: 1.068 seconds
Rows Returned: 4
Columns: 3

========== SQL QUERY RESULTS (TABLE) ==========
CUSTOMER_ID               | CUSTOMER_NAME             | TotalBalance             
------------------------- | ------------------------- | -------------------------
CUST001                   | Desert Manufacturing LLC  | 3780000.00               
CUST003                   | Southwest Energy Partners | 2649000.00               
CUST002                   | Palm Investors Inc.       | 1892000.00               
CUST004                   | Pacific Technology Soluti | 817000.00                

========== DAX EXECUTION RESULTS ==========
Status: ❌ FAILED
Error: Could not translate DAX query to SQL

========== RESULTS COMPARISON ==========
Results Match: ❌ NO
SQL Rows: 0
DAX Rows: 0
Summary: Cannot compare - one or both queries failed

Differences Found:
1. DAX query failed: Could not translate DAX query to SQL

========== PERFORMANCE ANALYSIS ==========
Total Pipeline Execution Time: 0.000 seconds
SQL Generation Time: 0.000 seconds
DAX Generation Time: 0.000 seconds
SQL Execution Time: 1.068 seconds
DAX Execution Time: 0.000 seconds

========== SCHEMA INFORMATION ==========
Database: Azure SQL Database
Tables Available: 0

========== ENVIRONMENT DETAILS ==========
Execution Environment: Streamlit Web Interface
Pipeline Version: Unified NL2SQL & DAX Pipeline
Report Generated: 2025-08-15 16:08:50
Working Directory: /Users/arturoquiroga/GITHUB/NL2DAX/CODE/NL2SQL_DAX_UNIFIED_PIPELINE

========== PIPELINE STATUS ==========
✅ Schema Reading: Complete
✅ SQL Generation: Complete
✅ DAX Generation: Complete
✅ SQL Execution: Complete
✅ DAX Execution: Failed
✅ Results Comparison: Complete
✅ Report Generation: Complete

---
Generated by NL2DAX Unified Pipeline - 2025-08-15 16:08:50
